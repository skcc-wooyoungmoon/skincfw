/**
 * Alopex Grid Search Plugin v1.0.1
 * http://grid.alopex.io
 *
 * Copyright (c) 2018 SK Holdings C&C. All rights reserved.
 * 
 * This software is the confidential and proprietary information of SK Holdings C&C.
 * You shall not disclose such confidential information and shall use it only in
 * accordance with the terms of the license agreement you entered into with SK Holdings C&C.
 *
 * Date : 2018-06-14 18:09:39 GMT+0900 (KST)
 **/
!function(e){function r(){!0===o.debug&&(a?console.error?console.error($.makeArray(arguments).join(" ")):console.log($.makeArray(arguments).join(" ")):console.error?console.error.apply(console,arguments):console.log.apply(console,arguments))}function t(e){return!(!e||!(e.nodeType||e.jquery&&e.length))}var i=null;if(e.AlopexGrid&&e.AlopexGrid.release?i=e.AlopexGrid:e[e.__AlopexGridExportName__]&&e[e.__AlopexGridExportName__].release&&(i=e[e.__AlopexGridExportName__]),!(i&&function(e,r){var t,i,o=/(\.0+)+$/,a=e.replace(o,"").split("."),n=r.replace(o,"").split("."),s=Math.min(a.length,n.length);for(t=0;t<s;t++)if(i=parseInt(a[t],10)-parseInt(n[t],10))return i;return a.length-n.length}(i.release,"3.9.0")>=0))return void console.error("AlopexGrid Search plugin needs AlopexGrid above version 3.9.0.");var o=function(){var r=this;if(this===e||null==this||this===i.plugin)if("function"==typeof Object.create)r=Object.create(o.prototype);else{var t=function(){};t.prototype=o.prototype,r=new t,t.prototype=null}return r.$grid=null,r.$searchWidget=null,r.widgetMarkup='<div class="alopexgrid-search-plugin-section"><input type="text" name="alopexgrid_search_keyword" class="alopexgrid-search-plugin-keyword"><span class="alopexgrid-search-plugin-result"></span></div><div class="alopexgrid-search-plugin-section"><button type="button" class="alopexgrid-search-plugin-search"></button><button type="button" class="alopexgrid-search-plugin-prev"></button><button type="button" class="alopexgrid-search-plugin-next"></button></div>',r.delay=500,r.resultRenderer=function(e,r){return e+" / "+r},r.searchOption={},r};o.release="1.0.1",o.version=o.release.split(".")[0];var a=!1;console.log.apply&&console.error.apply||(a=!0),o.prototype.setGrid=function(e){(t(e)||"string"==typeof e)&&(this.$grid=$(e))},o.prototype.setSearchWidget=function(e){if(t(e)||"string"==typeof e){var r=$(e);r.length&&(this.$searchWidget=r.addClass("alopexgrid-search-plugin").html(this.widgetMarkup))}},o.prototype.setSearchOption=function(e,r){if(e&&$.isPlainObject(e))for(var t in e)e.hasOwnProperty(t)&&(this.searchOption[t]=e[t]);else"string"==typeof e&&void 0!==r&&(this.searchOption[e]=r)},o.prototype.setSearchResult=function(e){var r=this;if(e&&$.isPlainObject(e)){var t=e.matchCount||0,i=t?Math.min(t,e.highlightPointer+1):0;r.$searchWidget.find(".alopexgrid-search-plugin-result").text(r.resultRenderer(i,t))}else r.$searchWidget.find(".alopexgrid-search-plugin-result").text("")},o.prototype.getUserKeyword=function(){return this.$searchWidget.find(".alopexgrid-search-plugin-keyword").val()},o.prototype.searchWithKeyword=function(e,r){var t=this,i=t.$grid.alopexGrid("pageInfo").current;if(e){var o=t.$grid.alopexGrid("searchInfo");if(t.searchKeyword==e&&o&&i===o.prevPage){var a=null;a=r?t.$grid.alopexGrid("searchPrevious"):t.$grid.alopexGrid("searchNext"),t.setSearchResult(a),!1===a&&(t.searchKeyword=null,e=t.getUserKeyword(),t.searchWithKeyword(e,r))}else t.searchKeyword=e,1==t.searchOption.showProgress?t.$grid.alopexGrid("startSearch",e,t.searchOption,function(){t.setSearchResult(t.$grid.alopexGrid("searchInfo"))}):t.setSearchResult(t.$grid.alopexGrid("startSearch",e,t.searchOption))}else{t.setSearchResult(t.$grid.alopexGrid("endSearch")),t.searchKeyword=null;t.$grid.__alopexgrid().state.alreadyUseFiltered=!1}},o.prototype.init=function(){var e=this;return e.$searchWidget&&e.$searchWidget.get(0)?e.$grid&&e.$grid.get(0)?(e.$searchWidget.off(".alopexGridSearchPlugin").on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-search",function(r){var t=e.getUserKeyword();e.searchWithKeyword(t,r.shiftKey)}).on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-prev",function(r){e.setSearchResult(e.getUserKeyword()==e.searchKeyword?e.$grid.alopexGrid("searchPrevious"):null)}).on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-next",function(r){e.setSearchResult(e.getUserKeyword()==e.searchKeyword?e.$grid.alopexGrid("searchNext"):null)}).on("keypress.alopexGridSearchPlugin",".alopexgrid-search-plugin-keyword",function(r){if(13==r.which){var t=e.getUserKeyword();e.searchWithKeyword(t,r.shiftKey)}}).on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-result",function(r){e.$searchWidget.find(".alopexgrid-search-plugin-keyword").focus()}),void e.$searchWidget.find(".alopexgrid-search-plugin-keyword").keypress()):(r("Search init failed - no grid set."),!1):(r("Search init failed - no search widget set."),!1)},o.prototype.getSearchResult=function(){var e=this.$grid.alopexGrid("searchInfo");return e&&e.matchDataList?[].concat(e.matchDataList):null},i.plugin.Search=o}(window);