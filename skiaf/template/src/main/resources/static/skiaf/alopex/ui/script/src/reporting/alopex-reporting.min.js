/**
 * Alopex UI v2.11.4
 * http://ui.alopex.io
 *
 * Copyright (c) 2018 SK Holdings C&C. All rights reserved.
 *
 * This software is the confidential and proprietary information of SK Holdings C&C
 * You shall not disclose such confidential information and shall use it only in
 * accordance with the terms of the license agreement you entered into with SK Holdings C&C.
 *
 * Date : 2018-10-25 15:35:05 GMT+0900 (대한민국 표준시)
 **/
$a.widget.reporting=$a.inherit($a.widget.object,{widgetName:"reporting",properties:{pdfFonts:{malgun:{normal:"malgun.ttf",bold:"malgunbd.ttf",italics:"malgun.ttf",bolditalics:"malgunbd.ttf"}},alopexGrid:{exportDragDropColumn:!0,exportSelectorColumn:!0,exportNumberingColumn:!0},defaultOptions:{pageSize:"A4",pageOrientation:"portrait",pageMargins:[40,60,40,60],pageBreak:"before",useRenderStyle:!0,defaultStyle:{font:"malgun",fontSize:8},repeatTableHeader:!1},useVerticalAlign:!0,pointRatio:72/92,pageSizeInfo:{"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]},styleInfoAttrName:"data-style",checked:{radio:{checkedText:"(*)",uncheckedText:"( )"},checkbox:{checkedText:"[v]",uncheckedText:"[ ]"}}}}),function(e){"use strict";void 0===e.fn.export&&e.fn.extend({export:function(t,o,l){var c=a=e.alopex.widget.reporting.properties,g=this;if(r=e.extend(!0,{},c.defaultOptions,t),l&&"pdf"!==l)return;c.pdfFonts&&(pdfMake.fonts=c.pdfFonts);!0===r.footer&&(r.footer=d);e.when(n(r.watermarkImage,r.pageSize,r.pageOrientation),i()).done(function(t,n){switch(r.watermarkImage&&"none"!=t&&(r.background=[{image:t}]),r.content=function(t,r){var n,o=[],i=a.styleInfoAttrName;if(r.useRenderStyle){Date.now();e(t).find("*").each(function(e,t){t.setAttribute(i,JSON.stringify(s(t)))})}e("input, textarea, select").each(function(){this.hasAttribute("id")||(n="Alopex_report_"+parseInt(1e4*Math.random()),this.setAttribute("id",n))});var d=document.createComment(""),l=document.createComment(""),c=t[0].childNodes[0];t[0].insertBefore(d,c),t[0].appendChild(l);for(var g,u=e(e(t).html().replace(/\n/g,"").replace(/[\t ]+\</g,"<").replace(/\>[\t ]+\</g,"><").replace(/\>[\t ]+$/g,">")),f=p(),b=!1,x=0;x<u.length;x++){var v=u.get(x);"|a|b|i|u|span|label|strong|#text".indexOf("|"+v.nodeName.toLowerCase())>-1?(b||(b=!0,g=p(),o.push(g)),h(g.text,v,f,s(t[0]))):(b=!1,h(o,v,f,s(t[0])))}return o}(g,r),o){case"open":default:r.window?pdfMake.createPdf(r).open({},r.window):pdfMake.createPdf(r).open();break;case"download":"function"==typeof r.downloadCallback?pdfMake.createPdf(r).download(r.filename,r.downloadCallback):pdfMake.createPdf(r).download(r.filename);break;case"print":r.window?pdfMake.createPdf(r).print({},r.window):pdfMake.createPdf(r).print()}return pdfMake.createPdf(r)}).fail(function(e){})}});var t,r,a,n=function(t,r,n){var o=n;void 0==o&&(o="portrait");var i,d,l,s,h,c,p=e.Deferred();return t&&t.image&&void 0!=t.image?(i=t,d=function(e){-1==e.indexOf("error")?p.resolve(e):p.reject(e)},l=r,s=o,h=new Image,c=a.pageSizeInfo,h.crossOrigin="Anonymous",h.onload=function(){var e,t=document.createElement("canvas"),r=t.getContext("2d"),a=l.toUpperCase();switch(s){case"portrait":t.width=c[a][0],t.height=c[a][1];break;case"landscape":t.width=c[a][1],t.height=c[a][0];break;default:t.width=c[a][0],t.height=c[a][1]}i.opacity&&(r.globalAlpha=i.opacity);var n=t.width/2-this.naturalWidth/2,o=t.height/2-this.naturalHeight/2;if("center"==i.type)i.rotate?(r.translate(n,o),r.translate(this.naturalWidth/2,this.naturalHeight/2),r.rotate(-i.rotate*Math.PI/180),r.drawImage(this,-this.naturalWidth/2,-this.naturalHeight/2)):r.drawImage(this,n,o);else{var h=10;i.tilesgap&&(h=i.tilesgap);var p=Math.ceil(t.width/this.naturalWidth),g=Math.ceil(t.height/this.naturalHeight);if(i.rotate)for(var u=0;u<g;u++)for(var f=0;f<p;f++){var b=f*(this.naturalWidth+h),x=u*(this.naturalHeight+h);r.save(),r.translate(b,x),r.translate(this.naturalWidth/2,this.naturalHeight/2),r.rotate(-i.rotate*Math.PI/180),r.drawImage(this,-this.naturalWidth/2,-this.naturalHeight/2),r.restore()}else for(var u=0;u<g;u++)for(var f=0;f<p;f++){var b=f*(this.naturalWidth+h),x=u*(this.naturalHeight+h);r.drawImage(this,b,x)}}if(i.grayscale){var v=r.getImageData(0,0,t.width,t.height);for(u=0;u<v.height;u++)for(f=0;f<v.width;f++){var m=4*u*v.width+4*f,y=v.data[m],w=v.data[m+1],k=v.data[m+2],A=v.data[m+3],I=(y+w+k)/3;v.data[m]=I,v.data[m+1]=I,v.data[m+2]=I,v.data[m+3]=A}r.putImageData(v,0,0,0,0,v.width,v.height)}e=t.toDataURL("image/png"),d(e)},h.onerror=function(e){d("error : Watermark Image URL is invalid.")},h.src=i.image):p.resolve("none"),p.promise()},o={},i=function(){var r,a=e.Deferred(),n=e("div.amcharts-main-div");return t=n.length,n.length?n.each(function(e){if(void 0===(r=this.parentElement).id&&(r.id="Alopex_report_c"+parseInt(1e4*Math.random())),AmCharts.charts)for(var n=0;n<AmCharts.charts.length;n++)if(AmCharts.charts[n].div&&AmCharts.charts[n].div.id===r.id){var i=AmCharts.charts[n];o[r.id]=i,i.export.capture({},function(){this.toPNG({multiplier:2},function(e){this.setup.chart.exportedImage=e,0==--t&&a.resolve("pass")})})}}):a.resolve("none"),a.promise()};function d(e,t){return{text:e.toString()+" / "+t,alignment:"center"}}function l(e){var t=a.pointRatio;return"number"!=typeof e&&(e=parseInt(e)),e*t}function s(t){var r={},a=window.getComputedStyle(t),n=["fontSize","color","backgroundColor","fontWeight","fontStyle","textAlign","width","height","marginLeft","marginTop","marginRight","marginBottom","display","verticalAlign","textDecorationLine","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];for(var o in a)n.indexOf(o)>-1&&("backgroundColor"!==o||"rgba(0, 0, 0, 0)"!==a[o]&&"transparent"!==a[o])&&(r[o]=a[o]);return"auto"===a.height&&(r.height=t.scrollHeight),"TR"===t.nodeName&&e(t).find("textarea").each(function(){var t=this.scrollHeight,n=parseInt(e("#"+this.id).css("lineHeight"),10),o=parseInt(t/n)*parseFloat(a.fontSize);parseFloat(r.height)<o&&(r.height=o)}),r}function h(t,n,i,d){var s=n.nodeType,h=n.nodeName.toLowerCase(),f=a.styleInfoAttrName;if(r.useRenderStyle&&s===Node.ELEMENT_NODE){if(n.getAttribute("alopex-databind-template"))return;if(n.getAttribute(f)){var b=JSON.parse(n.getAttribute(f));if("none"===b.display)return;"td"!==h&&"th"!==h||(b.height=d.height),d=b}}switch(h){case"#text":(i=p()).text=n.textContent.replace(/\n/g,""),u(i,d),t.push(i);break;case"b":case"strong":r.useRenderStyle||(d.fontWeight="bold"),c((i=p(n)).text,n,i,d),t.push(i);break;case"u":r.useRenderStyle||(d.textDecoration="underline"),c(t,n,i=p(n),d),t.push(i);break;case"i":r.useRenderStyle||(d.fontStyle="italic"),c(t,n,i,d);break;case"span":u(i=p(n),d),c(i.text,n,i,d),t.push(i);break;case"br":var y=t[t.length-1];"string"==typeof y.text?y.text+="\n":"[object Array]"==Object.prototype.toString.call(y.text)?y.text.push("\n"):t.push("\n");break;case"table":var w={table:{widths:[],body:[]}};r.repeatTableHeader&&(w.table.headerRows=e(n).find("thead").eq(0).children("tr").length);var k=n.getAttribute("border"),A=!0;k&&1==parseInt(k)&&(A=!0),A||(w.layout="noBorders"),c(w.table.body,n,i,d);var I=n.getElementsByTagName("colgroup")[0];if(I){var S=I.childNodes;w.table.widths=new Array(S.length);for(var O=0;O<S.length;O++){var C=S[O].style;if(C&&C.width){var T=C.width;-1!==T.indexOf("%")?w.table.widths[O]=T:w.table.widths[O]=l(S[O].style.width)}else w.table.widths[O]="*"}}for(var N=0;N<w.table.body.length;N++)for(var B=w.table.body[N],E=0;E<B.length;E++)if(void 0===B[E]&&(B[E]={}),B[E].rowSpan){var _,M=B[E].rowSpan;_=B[E].colSpan?B[E].colSpan:1;for(var W=1;W<M;W++){void 0===w.table.body[N+W]&&w.table.body.push(new Array(w.table.body[N].length));for(var R=0;R<_;R++)w.table.body[N+W].splice(E,0,{})}}!function(e,t){if(!t)return;var r,a,n,o;r=a=n=o=!1,void 0!==t.border&&"0px"!==t.border&&(r=a=n=o=!0);"0px"!==t.borderLeftWidth&&(r=!0);"0px"!==t.borderTopWidth&&(a=!0);"0px"!==t.borderRightWidth&&(n=!0);"0px"!==t.borderBottomWidth&&(o=!0);if(r)for(var i in e)void 0!==e[i][0].border&&(e[i][0].border[0]=!0);if(a)for(var i=0;i<e[0].length;i++)void 0!==e[0][i].border&&(e[0][i].border[1]=!0);if(n)for(var i in e){for(var d=e[i].length-1,l=d;l>0&&(void 0===e[i][l].border||x(e[i][l]));)l--;if(void 0!==e[i][l].border)if(l!==d&&e[i][l].colSpan){var s=e[i][l].colSpan;d-l==s-1&&(e[i][l].border[2]=!0)}else l!==d&&void 0===e[i][l].colSpan||(e[i][d].border[2]=!0)}if(o)for(var d=e.length-1,i=0;i<e[e.length-1].length;i++){for(var l=d;void 0==e[l][i].border&&l>0;){if(l>=1&&e[l-1][i].rowSpan){l--;break}l--}if(void 0!==e[l][i].border)if(l!==d&&e[l][i].rowSpan){var h=e[l][i].rowSpan;d-l==h-1&&(e[l][i].border[3]=!0)}else l!==d&&void 0===e[l][i].rowSpan||(e[l][i].border[3]=!0)}}(w.table.body,d),t.push(w);break;case"tbody":case"thead":c(t,n,i,d);break;case"tr":c(B=[],n,i,d),function(e,t){if(!t)return;var r,a,n,o;r=a=n=o=!1,void 0!==t.border&&"0px"!==t.border&&(r=a=n=o=!0);"0px"!==t.borderLeftWidth&&(r=!0);"0px"!==t.borderTopWidth&&(a=!0);"0px"!==t.borderRightWidth&&(n=!0);"0px"!==t.borderBottomWidth&&(o=!0);r&&void 0!==e[0].border&&(e[0].border[0]=!0);if(a)for(var i in e)void 0!==e[i].border&&(e[i].border[1]=!0);if(n){for(var i in e)void 0!==e[i].border&&(e[i].border[1]=!0);void 0!==e[e.length-1].border&&(e[e.length-1].border[2]=!0)}if(o)for(var i in e)void 0!==e[i].border&&(e[i].border[2]=!0)}(B,d),t.push(B);break;case"th":case"td":i=p(),c((z=g()).stack,n,i);var D=!0;for(var N in z.stack)if(!z.stack[N].hasOwnProperty("text")&&"string"!=typeof z.stack[N]){D=!1;break}e(n).children("p").length>0&&(D=!1),D&&delete(z={text:z.stack}).stack,t.push(z),d&&u(z,d);var L=n.getAttribute("rowspan");L&&(z.rowSpan=parseInt(L));var P=n.getAttribute("colspan");if(P){z.colSpan=parseInt(P);for(N=1;N<z.colSpan;N++)t.push({})}if(d&&u(z,d),r.useVerticalAlign){var G=z.stack||z.text,H=0;for(N in G){var F=G[N].height;"number"==typeof F&&F>H&&(H=F)}if(d&&d.verticalAlign&&1===n.childElementCount){var j=l(d.height)-H;if(i.margin||(i.margin=[0,0,0,0]),"TEXTAREA"===n.children[0].nodeName)break;switch(d.verticalAlign){case"middle":z.margin[3]=z.margin[1]=l(j/2)}}}break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":i=p(n),(z=g()).stack.push(i),u(z,d),c(z.stack,n,i,d),t.push(z);break;case"div":var z=g(),K=n.className.split(" ");if(e(n).find("> div.amcharts-main-div").length){n=document.getElementById(n.id);var J=window.getComputedStyle(n),U={image:o[n.id].exportedImage,fit:[l(J.width),l(J.height)],alignment:"center"};z.stack.push(U),t.push(z)}else if(K.indexOf("alopexgrid")>=0)!function(t,r,n,o){for(var i=[],d=r.getElementsByClassName("cell"),l=d[d.length-1],s=(parseInt(l.getAttribute("data-alopexgrid-columnindex")),parseInt(l.getAttribute("data-alopexgrid-rowindex")),function(t,r){var n,o=t.attr("data-alopexgrid"),i=t.data(AlopexGrid.KEY_NAME),d=e.extend(!0,{},i.state.groupingLookupTableMapById),l=t.alopexGrid("readOption"),s=l.columnMapping,h=i.state.columnIndexToKeyMap,c=function(t){var r;r=("2.3"===t.alopexGrid("readOption").version||"3"===t.alopexGrid("readOption").version)&&window[window.__AlopexGridExportName__]||AlopexGrid;var a=t.alopexGrid("readOption"),n=a.headerGroup,o=a.columnMapping,i=t.data(r.KEY_NAME).state.columnHeaderDepth;1==a.filteringHeader&&i--;var d=[],l=[],s=[],h=[],c=[];for(var p in o)o[p].hidden&&c.push(o[p]);if(!e.isEmptyObject(n)){d[d.length]={};for(var g=0;g<n.length;g++){1==n[n.length-1].hideSubTitle&&void 0==n[n.length-1].fromIndex&&(n[g].hideSubTitle=!0);var u=v(n[g],o,t,c);if(0!=u.length){for(var f=0,b=0;b<d.length;b++)for(var p=0;p<u.length;p++)if(void 0!=d[b][u[p].id]){f++;break}void 0==d[f]&&(d[f]={});for(var x=0;x<u.length;x++){if(u[x].id){if(d[f][u[x].id]=n[g].title.replace(/<br>/g,"\n"),h[f]||(h[f]=[]),h[f][o.indexOf(u[x])]=[],n[g].headerAlign){var y={align:n[g].headerAlign};h[f][o.indexOf(u[x])]=h[f][o.indexOf(u[x])].concat(y)}a.useCSSParser&&(h[f][o.indexOf(u[x])]=h[f][o.indexOf(u[x])].concat(getHeaderGroupStyle(f))),h[f][o.indexOf(u[x])]=h[f][o.indexOf(u[x])].concat(n[g].headerStyleclass)}1==n[g].hideSubTitle&&(o[o.indexOf(u[x])].hide=!0)}l.push(m(f,n[g],o,t,c))}}}for(var w=[],k=0;k<l.length;k++)if(l[k].rowspan){l[k].e.r=i-1;for(var A=l[k],I=l.length,S=0;S<I;S++)A.s.c<=l[S].s.c&&A.e.c>=l[S].e.c&&k!=S&&w.push(S)}if(w.length>0)for(var g=w.length-1;g>=0;g--)l.splice(w[g],1);d[d.length]={};for(var g=d.length;g>=0;g--)g>=i&&d.splice(g,1);for(var g=0;g<o.length;g++){if(1==o[g].hide)delete o[g].hide;else{"string"==typeof o[g].title?d[d.length-1][o[g].id]=o[g].title.replace(/<br>/g,"\n"):"function"==typeof o[g].title?d[d.length-1][o[g].id]=o[g].title(o[g]):d[d.length-1][o[g].id]="";for(var O=1,x=d.length-2;x>=0;x--)void 0==d[x][o[g].id]&&(d[x][o[g].id]=d[d.length-1][o[g].id],O++);O>1&&l.push({s:{r:d.length-O,c:g},e:{r:d.length-1,c:g}})}a.useGridColumnWidth&&s.push({wpx:parseInt(o[g].width)})}return{data:d,merges:l,headerGroupStyleMap:h,colWidth:s}}(t),p=e.extend(!0,[],i.state.dataKeyList),g=l.grouping.groupRowspanMode,f=[],b=0,x=i.state.groupHeaderDataMapById,y=i.state.groupFooterDataMapById,w=a.alopexGrid,k=a.styleInfoAttrName,A=a.checked,I=l.columnMapping.slice(i.state.renderFromColumnIndex,i.state.renderToColumnIndex+1),S=i.state.targetDataList.slice(i.state.renderFromRenderedIndex,i.state.renderToRenderedIndex+1),b=(function(e,t){for(var r={},a=0;a<e.length;a++){var n=e[a];if(n.hasOwnProperty("_index"))for(var o=0;o<t.length;o++){var i=t[o];i.hasOwnProperty("_index")&&n._index.id==i._index.id&&(r[n._index.id]=o)}}}(t.alopexGrid("dataGet"),S),0),O={},C=[];for(var T in I)I[T].hidden||!1===w.exportDragDropColumn&&I[ie].hasOwnProperty("dragDropColumn")||!1===w.exportSelectorColumn&&I[ie].hasOwnProperty("selectorColumn")||!1===w.exportNumberingColumn&&I[ie].hasOwnProperty("numberingColumn")?(C.push(I[T]),I.splice(T,1),p.splice(T,1)):O[I[T].key]=b++;for(var N=0;N<S.length;N++){var B=S[N],E=(B._index.row,B._state.hasOwnProperty("groupHeader")),_=B._state.hasOwnProperty("groupFooter"),M=B._state.hasOwnProperty("footer");for(var W in n=new Array(I.length),I){var R=I[W],D=n[W]={text:""};if(E||_){i.state.groupingKeyMap,E?d[B._state.groupHeader].groupKey:d[B._state.groupFooter].groupKey;var L=i._generateCellContent(B,R);if(L){var P=document.createElement("div");P.appendChild(L),D.text=e(P).text()}}else if(M);else{var G;if(R.hasOwnProperty("render")){if("function"==typeof R.render)G=R.render,"object"==typeof(j=G(S[N][R.key],S[N],R.render,R,t[0]))?j.nodeType?j=e(j).text():j instanceof jQuery&&j.prop("nodeType")&&(j=j.text()):"string"==typeof j&&/<[a-z][\s\S]*>/i.test(j)&&(tmpDIV.innerHTML=j,j=$tmpDIV.text()),D.text=j;else if(R.render.hasOwnProperty("type")){var H=R.render;switch(H.type){case"radio":var F="",j=S[N][h[W]];for(var z in H.rule)F+=H.rule[z].value===j?A.radio.checkedText:A.radio.unchecked,F+=H.rule[z].text;D.text=F;break;case"text":default:D.text=""+S[N][h[W]]}}}else R.hasOwnProperty("selectorColumn")?(D.text=S[N]._state.selected?A.checkbox.checkedText:A.checkbox.uncheckedText,D.noWrap=!0):R.hasOwnProperty("dragdropColumn")?(D.text="::",D.noWrap=!0):R.hasOwnProperty("numberingColumn")?D.text=""+N:D.text=""+S[N][h[W]]}if(b=0,Ae={},!0!==R.hidden){var K=o;if(K+="-"+N+"-"+W,(ke=document.getElementById(K))&&ke.hasAttribute(k))Ae=JSON.parse(ke.getAttribute(k)),u(D,Ae),D.border=[!0,!0,!0,!0];else{if(e(".bodycell[data-alopexgrid-columnindex="+W+"]").length){var J=e(".bodycell[data-alopexgrid-columnindex="+W+"]").find("["+k+"]");J.length&&J[0].hasAttribute(k)&&(Ae=JSON.parse(J[0].getAttribute(k)))}else if(e(".bodycell[data-alopexgrid-rowindex="+N+"]").length){var U=e(".bodycell[data-alopexgrid-rowindex="+N+"]").find("["+k+"]");U.length&&U[0].hasAttribute(k)&&(Ae=JSON.parse(U[0].getAttribute(k)))}u(D,Ae),D.border=[!0,!0,!0,!0]}b++}}f.push(n)}for(var V in d){var $=d[V],q=$.member,Y=x[V]?x[V]._index.row:null,Q=y[V]?y[V]._index.row:null,X=$.groupDepth;switch(g){case 0:var Z=q[0]._index.row;if(X===l.grouping.by.length-1)for(var ee=q[q.length-1]._index.row,te=X;te>=0;te--){var re=O[l.grouping.by[te]];e.extend(!0,f[Z][re],{rowSpan:ee-Z+1});for(var ae=Z+1;ae<=ee;ae++)f[ae][re]={}}break;case 1:default:for(var Z=q[0]._index.row,ee="number"==typeof Q?Q:q[q.length-1]._index.row,ne=Q-Z,re=O[l.grouping.by[X]],N=Z+1;N<ee;N++)f[N][re]={};e.extend(!0,f[Z][re],{rowSpan:ne}),X<l.grouping.by.length-1&&(f[Q][re].colSpan=l.grouping.by.length-re);break;case 2:for(var Z="number"==typeof Y?Y:q[0]._index.row,ee=Q,re=O[l.grouping.by[X]],N=Z+1;N<ee;N++)f[N][re]={};e.extend(!0,f[Z][re],{rowSpan:ee-Z+1})}}if(l.footer.position){var oe=e(".footercell");n=new Array(I.length);for(var ie=0;ie<I.length;ie++)n[ie]={text:""},oe.eq(ie).attr(k)&&u(n[ie],JSON.parse(oe.eq(ie).attr(k))),n[ie].border=[!0,!0,!0,!0];var de=e.extend(!0,{},t.alopexGrid("readOption").footer.footerMapping);for(var le in de){var se=i._footerValueByMapping(de[le]);n[de[le].columnIndex].text=se}if("top"===l.footer.position){var P=[];P.push(n),f=P.concat(f)}else f.push(n)}for(var he={},ce=S.length,le=0;le<ce;le++)for(var pe=1;pe<s.length;pe++){var ge=i._getColspanUpto(S[le],s[pe-1]);if(ge&&ge>=s[pe-1].columnIndex){var ue=I[ge],fe=I[s[pe-1].columnIndex];he[le]?he[le].push({colFrom:fe,colTo:ue}):(he[le]={colFrom:fe,colTo:ue},he[le]=[he[le]],pe=ue+1)}}for(var z in he){var be=he[z][0].colFrom.key,xe=he[z][0].colTo.key,ve=O[be],me=O[xe];f[z][ve].colSpan=me-ve+1}var P=[];for(var z in c.data){n=new Array(I.length);for(var ye=c.data[z],b=0,N=0;N<l.columnMapping.length;N++){var we=l.columnMapping[N];if(N>=i.state.renderFromColumnIndex&&N<=i.state.renderToColumnIndex&&!0!==we.hidden){we.hasOwnProperty("selectorColumn")&&we.selectorColumn?(i.state.selectAll?n[b]={text:A.checkbox.checkedText}:n[b]={text:A.checkbox.uncheckedText},n[b].noWrap=!0):n[b]={text:ye[we.id]};var ke,K=o;if(K+="-h-"+z+"-"+N,(ke=document.getElementById(K))&&ke.hasAttribute(k)){var Ae=JSON.parse(ke.getAttribute(k));Ae.verticalAlign="middle",u(n[b],Ae),n[b].border=[!0,!0,!0,!0]}else e(".headercell[data-alopexgrid-columnindex]").eq(0).attr(k)&&(Ae=JSON.parse(e(".headercell[data-alopexgrid-columnindex]").eq(0).attr(k)),u(n[b],Ae));b++}}P.push(n)}for(var T in f=P.concat(f),c.merges){var Ie=c.merges[T];if(Ie.e.r-Ie.s.r>0){f[Ie.s.r][Ie.s.c].rowSpan=Ie.e.r-Ie.s.r+1;for(var b=Ie.s.r+1;b<=Ie.e.r;b++)f[b][Ie.s.c]={}}if(Ie.e.c-Ie.s.c>0){f[Ie.s.r][Ie.s.c].colSpan=Ie.e.c-Ie.s.c+1;for(var b=Ie.s.c+1;b<=Ie.e.c;b++)!0!==l.columnMapping[b].hidden&&(f[Ie.s.r][b]={})}}return f}(e("#"+r.id))),h=0;h<s[0].length;h++)i.push("*");t.push({table:{body:s,width:i}})}(t,n);else if(K.indexOf("Divselect")>=0)t.push(n.getElementsByTagName("span")[0].innerText);else if(K.indexOf("Dateinput")>=0){var V=document.getElementById(n.getElementsByTagName("input")[0].id);t.push(V.value)}else c(z.stack,n,z,d),u(z,d),t.push(z);break;case"p":c((i=p(n)).text,n,i,d),u(i,d),t.push(i);break;case"img":var $=document.createElement("canvas");$.width=2*parseInt(d.width),$.height=2*parseInt(d.height),$.getContext("2d").drawImage(n,0,0,$.width,$.height);var q=$.toDataURL("image/png");t.push({image:q,width:l(d.width),height:l(d.height)});break;case"label":c((i=p(n)).text,n,i,d),t.push(i);break;case"select":i=p(n),(n=document.getElementById(n.id)).disabled&&(i.style||(i.style=[]),i.style.push("disabled")),i.text=n.value,t.push(i);break;case"textarea":i=p(n),n=document.getElementById(n.id),i.text=n.value,t.push(i);break;case"input":w={text:""};var Y=n.className,Q=a.checked;n=document.getElementById(n.id),Y&&Y.indexOf("Textinput")>=0||"text"===n.type?w.text=n.value:Y&&Y.indexOf("Checkbox")>=0||"checkbox"===n.type?w.text=n.checked?Q.checkbox.checkedText:Q.checkbox.uncheckedText:(Y&&Y.indexOf("Radio")>=0||"radio"===n.type)&&(w.text=n.checked?Q.radio.checkedText:Q.radio.uncheckedText),t.push(w.text);break;case"ul":var X={ul:[]};c(X.ul,n,X.ul,d),t.push(X),u(X,d);break;case"ol":var Z={ol:[]};n.getAttribute("start")&&(Z.start=parseInt(n.getAttribute("start"))),c(Z.ol,n,Z.ol,d),t.push(Z),u(Z,d);break;case"li":c((i=p()).text,n,i,d),t.push(i);break;case"a":(i=p(n)).text=n.text,i.link=n.href,u(i,d),t.push(i);break;default:"#comment"!==n.nodeName&&c(t,n,i=p(n),d)}return i}function c(e,t,r,a){var n=[],o=t.childNodes;if(t.getAttribute("data-export-style")&&(r.style=t.getAttribute("data-export-style")),0!=o.length)for(var i=0;i<o.length;i++)r=h(n,o[i],r,a);var d=!0;if(0!==n.length)for(i=0;i<n.length;i++)"string"!=typeof n[i].text&&(d=!1),n[i].text+"",e.push(n[i]);return d&&r&&"object"==typeof r.text&&r.text.length>0&&((e=new Array).push(r.text.join(" ")),r.text=r.text.join(" ")),r}function p(e){var t={text:[]};e&&e.hasAttribute("data-pagebreak")&&("true"===e.getAttribute("data-pagebreak").toLowerCase()&&(t.pageBreak="before"));return t}function g(){return{stack:[]}}function u(e,t){if(t)for(var r in t)switch(r){case"bold":e.bold=t[r];break;case"fontSize":e.fontSize=l(t[r]);break;case"verticalAlign":if(e.rowSpan&&e.rowSpan>1);else switch(t[r]){case"middle":e.verticalAlign="center";break;case"bottom":e.verticalAlign="bottom"}break;case"textAlign":switch(t[r]){case"right":e.alignment="right";break;case"center":e.alignment="center"}break;case"fontWeight":if(isNaN(t[r]))switch(t[r]){case"bold":e.bold=!0}else t[r]>=600&&(e.bold=!0);break;case"textDecorationLine":case"textDecoration":switch(t[r]){case"underline":e.decoration="underline"}break;case"fontStyle":switch(t[r]){case"italic":e.italics=!0}break;case"color":t[r]&&(e.color=f(t[r]));break;case"backgroundColor":t[r]&&(e.fillColor=f(t[r]));break;case"borderWidth":"0px"===t[r].split(" ")[0]&&(e.border=[!1,!1,!1,!1]);break;case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":e.border||(e.border=[!1,!1,!1,!1]);"0px"!==t[r].split(" ")[0]&&(e.border[{borderLeftWidth:0,borderTopWidth:1,borderRightWidth:2,borderBottomWidth:3}[r]]=!0);break;case"marginLeft":case"marginRight":case"marginTop":case"marginBottom":e.margin||(e.margin=[0,0,0,0]);e.margin[{marginLeft:0,marginTop:1,marginRight:2,marginBottom:3}[r]]=l(t[r]);break;case"height":var a=l(t[r]);e.height=a}}function f(e){var t=e.replace(" ","").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return t?"#"+b(t[1])+b(t[2])+b(t[3]):function(e){var t=e.substring(e.indexOf("(")).split(","),r=parseInt(t[0].substring(1),10),a=parseInt(t[1],10),n=parseInt(t[2],10),o=parseFloat(t[3]);if(r>255||a>255||n>255||o>255)throw"Invalid color component";var i=(256+r).toString(16).substr(1)+((1<<24)+(a<<16)|n<<8|o).toString(16).substr(1);return"#"+(i=i.substr(0,6))}(e)}function b(e){var t=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");return isNaN(e)?"00":t[(e-e%16)/16]+t[e%16]}function x(e){for(var t in e)return!1;return!0}function v(e,t,r,a){for(var n=[],o=y(r,[e.fromIndex,e.toIndex],a),i=0;i<t.length;i++)t[i].columnIndex>=o[0]&&t[i].columnIndex<=o[1]&&n.push(t[i]);return n}function m(e,t,r,a,n){var o={s:{r:e,c:-1},e:{r:e,c:-1}};t.hideSubTitle&&(o.rowspan=!0);for(var i=y(a,[t.fromIndex,t.toIndex],n),d=0;d<r.length;d++)r[d].columnIndex==i[0]&&(o.s.c=d),r[d].columnIndex!=i[1]?d===r.length-1&&-1===o.e.c&&(o.e.c=d):o.e.c=d;return o}function y(t,r,a){var n,o=t,i=[];if("2.3"===o.alopexGrid("readOption").version||"3"===o.alopexGrid("readOption").version){var d=window[window.__AlopexGridExportName__]||AlopexGrid;n=o.data(d.KEY_NAME)}else n=o.data(AlopexGrid.KEY_NAME);for(var l=0;l<r.length;l++){var s=r[l];if("number"==typeof s)i.push(parseInt(s));else if("string"==typeof s){var h=e.grep(n.option.columnMapping,function(e){return e.id==s});0==h.length&&(h=e.grep(n.option.columnMapping,function(e){return e.key==s})),i.push(h[0].columnIndex)}}for(var c=!0;1==c;)a.indexOf(i[0])>-1&&i[0]++,a.indexOf(i[1])>-1&&i[1]--,-1==a.indexOf(i[0])&&-1==a.indexOf(i[1])&&(c=!1);return i}}(jQuery);